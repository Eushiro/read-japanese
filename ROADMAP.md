# SanLang - Vision & Roadmap

## Project Evolution

**From:** Read Japanese (JLPT graded reader for Japanese learners)
**To:** **SanLang** - Multi-language exam prep platform with AI-powered personalization

---

## Core Brand Promise

**"Personalized Exam Prep"** - AI generates content tailored to YOUR vocabulary and YOUR target exam. Not generic study materials, but a learning path built around what you need to learn.

---

## Key Differentiators

| What We Do | What Others Do |
|------------|----------------|
| **Active output** - Create sentences, write analyses | Passive recall - flashcards, multiple choice |
| **AI verification** - Instant feedback on your writing | Right/wrong answers only |
| **Personalized content** - Stories/tests from your vocab | Generic content for everyone |
| **Exam-aligned** - Real test formats and rubrics | Gamified but not exam-focused |
| **Multi-modal** - Text, audio, images, YouTube | Usually single-modal |

---

## Supported Languages & Exams

Each language is a **separate track** with culturally appropriate content:

| Language | Target Exams | Content Themes | Phase |
|----------|--------------|----------------|-------|
| **Japanese** | JLPT N5-N1 | Daily life, manga culture, news, travel | MVP |
| **English** | TOEFL, SAT, GRE | Academic reading, test strategies, vocabulary | MVP |
| **French** | DELF/DALF, TCF | Culture, literature, daily life, news | MVP |
| **Chinese** | HSK 1-6, é«˜è€ƒ, ä¸­è€ƒ | Modern China, classical literature, news | Future |

**Note:** Chinese support is deferred to a future phase. MVP focuses on Japanese, English, and French.

---

## The Learning Loop

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         INPUT MODES                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“– Reading        ğŸ§ Audio         ğŸ–¼ï¸ Images      ğŸ¬ YouTube     â”‚
â”‚  Graded stories    Narration        Describe &     Embedded      â”‚
â”‚  Exam passages     Dialogues        analyze        videos        â”‚
â”‚  News articles     Podcasts         scenes         + questions   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    VOCABULARY CAPTURE                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Automatic addition (reduce user effort):                        â”‚
â”‚  â€¢ Pre-populated most common word lists per level                â”‚
â”‚  â€¢ Auto-add words from mistakes in user's output                 â”‚
â”‚  â€¢ Auto-add unfamiliar words from content consumption            â”‚
â”‚                                                                  â”‚
â”‚  Manual addition:                                                â”‚
â”‚  â€¢ Tap words to save while reading/listening                     â”‚
â”‚  â€¢ Manual input for specific words                               â”‚
â”‚  â€¢ Import from external vocabulary lists                         â”‚
â”‚  â€¢ Extract from YouTube video transcripts                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FLASHCARD SYSTEM (Anki-style SRS)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Auto-generated cards with:                                      â”‚
â”‚  â€¢ Word + reading + definition                                   â”‚
â”‚  â€¢ AI-generated example sentence (at your level)                 â”‚
â”‚  â€¢ Translation of the sentence                                   â”‚
â”‚  â€¢ Audio narration of the sentence                               â”‚
â”‚  â€¢ Periodic sentence refresh (keep it fresh)                     â”‚
â”‚                                                                  â”‚
â”‚  SRS Algorithm (FSRS - Anki's algorithm):                        â”‚
â”‚  â€¢ Use ts-fsrs library (github.com/open-spaced-repetition/ts-fsrsâ”‚
â”‚  â€¢ Mastered words still appear occasionally (prevents forgetting)â”‚
â”‚  â€¢ Algorithm adapts to individual learning patterns              â”‚
â”‚  â€¢ State: New â†’ Learning â†’ Review â†’ Relearning                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    OUTPUT PRACTICE                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Vocabulary-based output:                                        â”‚
â”‚  â€¢ Create a sentence using a target word                         â”‚
â”‚  â€¢ AI verifies grammar, usage, naturalness                       â”‚
â”‚  â€¢ Get feedback and corrections                                  â”‚
â”‚  â€¢ Words from mistakes auto-added to vocabulary                  â”‚
â”‚                                                                  â”‚
â”‚  Post-consumption output (after reading/watching/listening):     â”‚
â”‚  â€¢ Answer comprehension questions                                â”‚
â”‚  â€¢ Summarize what you consumed                                   â”‚
â”‚  â€¢ Predict what happens next                                     â”‚
â”‚  â€¢ Write analysis of content                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LISTENING PRACTICE                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Multiple modes:                                                 â”‚
â”‚  â€¢ Audio + comprehension questions (JLPT/TOEFL listening style)  â”‚
â”‚  â€¢ Dictation - listen, type what you hear                        â”‚
â”‚  â€¢ Audio flashcards - hear word/sentence, recall meaning         â”‚
â”‚  â€¢ Shadowing with AI feedback - repeat after audio, AI evaluates â”‚
â”‚    pronunciation/fluency (requires speech recognition)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  PERSONALIZED CONTENT                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  AI generates content from YOUR vocabulary:                      â”‚
â”‚  â€¢ Stories featuring words you're learning                       â”‚
â”‚  â€¢ Mock tests with your vocabulary                               â”‚
â”‚  â€¢ Comprehension passages using target words                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MOCK EXAMS                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  AI-generated tests in real exam formats:                        â”‚
â”‚  â€¢ JLPT: Reading + listening sections                            â”‚
â”‚  â€¢ TOEFL: Reading, listening, writing sections                   â”‚
â”‚  â€¢ SAT: Reading comprehension + essay                            â”‚
â”‚  â€¢ Scoring aligned with actual exam rubrics                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Monetization: Subscription Tiers with Usage Limits

No visible "credits" - just subscription tiers with different usage allowances.
Users upgrade to unlock more usage, simpler UX than tracking credits.

| Tier | Price | What's Included |
|------|-------|-----------------|
| **Free** | $0 | Limited vocab, basic flashcards, X stories/month, Y AI checks/month |
| **Basic** | $X/mo | More stories, more AI verification, all content |
| **Pro** | $Y/mo | Higher limits, personalized story generation, mock tests |
| **Unlimited** | $Z/mo | No limits on AI generation, priority support |

Usage limits (example):
- Free: 50 AI sentence checks/month, 5 stories
- Basic: 200 AI checks/month, 20 stories, 5 personalized stories
- Pro: 1000 AI checks/month, unlimited reading, 20 personalized stories, 10 mock tests
- Unlimited: No limits

---

## Phased Roadmap

---

## Implementation Status Overview

| Phase | Name | Status | Progress |
|-------|------|--------|----------|
| 0 | Infrastructure | âœ… Complete | Clerk auth, Convex deployed |
| 1 | Flashcard Foundation | ğŸš§ In Progress | UI complete, Stripe setup + audio pending |
| 2 | Active Output Verification | âœ… UI Complete | Practice page with AI feedback |
| 3 | Personalized Story Generation | âŒ Not Started | - |
| 4 | Multi-Language Foundation | âœ… UI Complete | Language/exam settings in UI |
| 5 | Mock Test Generation | âœ… Backend Ready | Schema + functions done |
| 6 | YouTube Integration | âŒ Not Started | Schema placeholder only |
| 7 | Image-Based Learning | âŒ Not Started | - |
| 8 | Email Marketing | âŒ Not Started | - |

---

### Phase 0: Infrastructure
**Goal:** Set up core platform infrastructure

**Status:** âœ… Complete

| Task | Status | Notes |
|------|--------|-------|
| Convex schema (all tables) | âœ… Complete | `web/convex/schema.ts` |
| Convex functions (vocabulary) | âœ… Complete | `web/convex/vocabulary.ts` |
| Convex functions (flashcards) | âœ… Complete | `web/convex/flashcards.ts` with FSRS |
| Convex functions (subscriptions) | âœ… Complete | `web/convex/subscriptions.ts` |
| Convex functions (user sentences) | âœ… Complete | `web/convex/userSentences.ts` |
| Convex functions (mock tests) | âœ… Complete | `web/convex/mockTests.ts` |
| Convex functions (users) | âœ… Complete | `web/convex/users.ts` |
| Convex functions (settings) | âœ… Complete | `web/convex/settings.ts` |
| Convex functions (progress) | âœ… Complete | `web/convex/progress.ts` |
| Clerk auth integration | âœ… Complete | Clerk provider + Convex JWT auth configured |
| Remove Firebase | âœ… Complete | Firebase package and config removed |
| Deploy schema to Convex | âœ… Complete | Schema deployed with all indexes |

---

### Phase 1: Flashcard Foundation (MVP)
**Goal:** Transform vocabulary saving into active learning

**Status:** ğŸš§ In Progress

| Feature | Status | Notes |
|---------|--------|-------|
| Enhanced vocabulary input (backend) | âœ… Complete | Convex functions support manual, import, bulk add |
| Enhanced vocabulary input (UI) | âœ… Complete | VocabularyPage with add/filter/search |
| Auto-generated flashcards (backend) | âœ… Complete | Schema + create function done |
| Auto-generated flashcards (AI integration) | âœ… Complete | OpenRouter integration in `convex/ai.ts` |
| Auto-generated flashcards (UI) | âœ… Complete | Generate button on vocabulary cards |
| Sentence refresh (backend) | âœ… Complete | `nextRefreshAt` field + `updateSentence` mutation |
| Sentence refresh (scheduled job) | âŒ Not Started | Need Convex cron job |
| Basic spaced repetition (backend) | âœ… Complete | FSRS algorithm in `flashcards.ts` |
| Basic spaced repetition (UI) | âœ… Complete | FlashcardsPage with review interface |
| Audio flashcards (backend) | âœ… Complete | `audioUrl` field on flashcards |
| Audio flashcards (TTS integration) | âŒ Not Started | Need ElevenLabs integration |
| Audio flashcards (UI) | âœ… Complete | Audio play button on flashcard display |

**Tech notes:**
- Leverage existing OpenRouter/Gemini for sentence generation
- Leverage existing ElevenLabs for audio
- New vocabulary input UI (React)
- New flashcard review UI

---

### Phase 2: Active Output Verification
**Goal:** Users must produce, not just recognize

**Status:** âœ… UI Complete

| Feature | Status | Notes |
|---------|--------|-------|
| Sentence creation (backend) | âœ… Complete | `userSentences.ts` with submit mutation |
| Sentence creation (UI) | âœ… Complete | `PracticePage.tsx` with word selection and input |
| AI verification (backend schema) | âœ… Complete | Scores + corrections in schema |
| AI verification (AI integration) | âœ… Complete | `verifySentence` action in `convex/ai.ts` |
| Mastery tracking (backend) | âœ… Complete | `masteryState` field + `updateMastery` mutation |
| Mastery tracking (UI) | âŒ Not Started | Need progress visualization |
| Feedback loop (backend) | âœ… Complete | `corrections`, `feedback`, `improvedSentence` fields |
| Feedback loop (UI) | âœ… Complete | Score bars, corrections, improved sentence display |

**Tech notes:**
- Use Claude/GPT for verification (more nuanced than rule-based)
- Store user sentences and AI feedback
- New UI for sentence input and feedback display

---

### Phase 3: Personalized Story Generation
**Goal:** Content that reinforces YOUR vocabulary

**Status:** âŒ Not Started

| Feature | Status | Notes |
|---------|--------|-------|
| Stories from your words | âŒ Not Started | Need AI generation pipeline |
| Comprehension questions | âŒ Not Started | Need question generation |
| Integration with flashcards | âŒ Not Started | Need linking logic |

**Tech notes:**
- Extend existing story generation pipeline
- Add vocabulary seeding to generation prompts
- New question generation component

---

### Phase 4: Multi-Language Foundation
**Goal:** Language-agnostic architecture

**Status:** âœ… UI Complete

| Feature | Status | Notes |
|---------|--------|-------|
| Language selection (backend) | âœ… Complete | `users.languages`, `users.primaryLanguage` |
| Language selection (UI) | âœ… Complete | Settings page with language/exam picker |
| Exam-specific vocabulary (schema) | âœ… Complete | `examTypeValidator` with all exams |
| Exam-specific vocabulary (data) | âŒ Not Started | Need to import word lists |
| Language-specific tokenization | âŒ Not Started | Japanese exists in legacy backend |
| Separate content tracks (backend) | âœ… Complete | `language` field on all models |
| Separate content tracks (UI) | âœ… Complete | Vocabulary page filters by language |

**Supported exams in schema:**
- Japanese: JLPT N5-N1
- English: TOEFL, SAT, GRE
- French: DELF A1-B2, DALF C1-C2, TCF

**Tech notes:**
- Abstract tokenization behind interface
- Language field on all content models
- Separate vocabulary list sources per language

---

### Phase 5: Mock Test Generation
**Goal:** AI-generated exams in real formats

**Status:** âœ… Backend Ready

| Feature | Status | Notes |
|---------|--------|-------|
| Exam format templates (schema) | âœ… Complete | `mockTests` table with sections/questions |
| Exam format templates (AI generation) | âŒ Not Started | Need AI integration |
| Personalized test generation | âŒ Not Started | Need AI + vocabulary integration |
| Scoring and analytics (backend) | âœ… Complete | `grade` mutation, score fields |
| Scoring and analytics (UI) | âŒ Not Started | Need results visualization |
| Timed practice (backend) | âœ… Complete | `timeLimitMinutes`, `startedAt`, `completedAt` |
| Timed practice (UI) | âŒ Not Started | Need timer component |
| Listening comprehension (backend) | âœ… Complete | `audioUrl` on sections |
| Listening comprehension (audio gen) | âŒ Not Started | Need TTS integration |
| Dictation exercises | âŒ Not Started | Need speech-to-text comparison |

---

### Phase 6: YouTube Integration
**Goal:** Learn from real video content

**Status:** âŒ Not Started (schema placeholder only)

| Feature | Status | Notes |
|---------|--------|-------|
| YouTube embeds | âŒ Not Started | `youtubeContent` table exists |
| Transcript extraction | âŒ Not Started | Need YouTube API integration |
| Comprehension layer | âŒ Not Started | Need AI question generation |
| Listening practice | âŒ Not Started | Need UI components |

---

### Phase 7: Image-Based Learning
**Goal:** Multi-modal comprehension

**Status:** âŒ Not Started

| Feature | Status | Notes |
|---------|--------|-------|
| Image description practice | âŒ Not Started | Need image + input UI |
| Image comprehension questions | âŒ Not Started | Need AI vision integration |
| AI image generation for prompts | âŒ Not Started | DALL-E 3 exists in legacy |

---

### Phase 8: Email Marketing & User Engagement
**Goal:** Drive retention and re-engagement through personalized email campaigns

**Status:** âŒ Not Started

| Feature | Status | Notes |
|---------|--------|-------|
| Transactional emails | âŒ Not Started | Need email provider setup |
| Engagement campaigns | âŒ Not Started | Need automation platform |
| Re-engagement campaigns | âŒ Not Started | Need user activity tracking |
| Educational drip campaigns | âŒ Not Started | Need content creation |
| User preferences (backend) | âŒ Not Started | Need to add to schema |
| User preferences (UI) | âŒ Not Started | Need settings UI |

**Features:**
1. **Transactional emails**
   - Welcome email on signup
   - Password reset
   - Subscription confirmation/changes
   - Weekly progress summary

2. **Engagement campaigns**
   - "You have X cards due for review" reminders
   - Streak maintenance reminders
   - "New content in your language" announcements
   - Personalized study tips based on performance

3. **Re-engagement campaigns**
   - "We miss you" for inactive users (7, 14, 30 days)
   - "Your vocabulary is fading" with data on words needing review
   - Special offers for churned users

4. **Educational drip campaigns**
   - Onboarding series (how to use SRS effectively)
   - Exam prep tips leading up to test dates
   - Weekly vocabulary spotlights

5. **User preferences**
   - Email frequency settings (daily/weekly/monthly/none)
   - Content type preferences
   - Unsubscribe management

**Tech notes:**
- Use Resend, SendGrid, or Postmark for transactional emails
- Consider Loops, Customer.io, or Mailchimp for marketing automation
- Store email preferences in user settings
- Convex scheduled functions for automated sends
- Track open rates, click rates for optimization

**Potential providers:**
| Provider | Use Case | Notes |
|----------|----------|-------|
| **Resend** | Transactional | Developer-friendly, React Email support |
| **Loops** | Marketing automation | Built for SaaS, good drip campaigns |
| **Customer.io** | Both | Powerful segmentation, event-based |
| **Postmark** | Transactional | Excellent deliverability |

---

## Architecture Considerations

### Data Models (Implemented in Convex)

```
User
â”œâ”€â”€ languages: [Language]           # Languages user is learning
â”œâ”€â”€ targetExams: [Exam]             # Exams user is preparing for
â””â”€â”€ emailPreferences                # Email marketing settings

VocabularyItem (enhanced)
â”œâ”€â”€ language: Language
â”œâ”€â”€ word, reading, definitions
â”œâ”€â”€ sourceType: story | manual | import | youtube
â”œâ”€â”€ masteryState: new | learning | tested | mastered
â”œâ”€â”€ flashcards: [Flashcard]
â”œâ”€â”€ userSentences: [UserSentence]
â””â”€â”€ reviewHistory: [Review]

Flashcard
â”œâ”€â”€ vocabularyItemId
â”œâ”€â”€ sentence, translation, audioUrl
â”œâ”€â”€ createdAt
â”œâ”€â”€ nextRefreshAt
â””â”€â”€ reviewData: SRS fields

UserSentence
â”œâ”€â”€ vocabularyItemId
â”œâ”€â”€ sentence
â”œâ”€â”€ aiVerification: VerificationResult
â”œâ”€â”€ createdAt
â””â”€â”€ corrections

MockTest
â”œâ”€â”€ language, examType
â”œâ”€â”€ sections: [TestSection]
â”œâ”€â”€ score, completedAt
â””â”€â”€ vocabularyTargeted: [VocabularyItem]

YouTubeContent
â”œâ”€â”€ videoId, title
â”œâ”€â”€ language
â”œâ”€â”€ transcript: tokenized
â”œâ”€â”€ questions: [Question]
â””â”€â”€ vocabularyExtracted: [VocabularyItem]

EmailCampaign
â”œâ”€â”€ userId
â”œâ”€â”€ campaignType
â”œâ”€â”€ sentAt
â”œâ”€â”€ openedAt
â”œâ”€â”€ clickedAt
â””â”€â”€ metadata
```

### Subscription & Usage Tracking

```
Subscription
â”œâ”€â”€ userId
â”œâ”€â”€ tier: free | basic | pro | unlimited
â”œâ”€â”€ startDate, renewalDate
â””â”€â”€ status: active | cancelled | expired

UsageRecord
â”œâ”€â”€ userId
â”œâ”€â”€ period: { month, year }
â”œâ”€â”€ aiVerifications: Int
â”œâ”€â”€ storiesRead: Int
â”œâ”€â”€ personalizedStoriesGenerated: Int
â”œâ”€â”€ mockTestsGenerated: Int
â””â”€â”€ updatedAt

UsageLimits (per tier)
â”œâ”€â”€ tier
â”œâ”€â”€ aiVerificationsPerMonth
â”œâ”€â”€ storiesPerMonth
â”œâ”€â”€ personalizedStoriesPerMonth
â””â”€â”€ mockTestsPerMonth
```

---

## Platform Strategy

**Decision: React (Web) + React Native (Mobile)**

**Current approach:**
1. **Web app with React** - Current implementation in `/web`
2. **Future mobile with React Native** - Cross-platform iOS/Android
3. **Shared Convex backend** - Single source of truth for data
4. **Clerk for auth** - Unified authentication across platforms

---

## Tech Stack

| Layer | Technology |
|-------|------------|
| **Frontend (Web)** | React + Vite + TailwindCSS |
| **Frontend (Mobile)** | React Native + Expo (future) |
| **Backend** | Convex (database + functions) |
| **Auth** | Clerk |
| **AI** | OpenRouter (Claude/GPT), Gemini |
| **Audio** | ElevenLabs TTS |
| **Images** | DALL-E 3 |
| **Email** | Resend or Loops (TBD) |

---

## Decisions Made

1. **Branding: SanLang**
   - ä¸‰ (san) = three in Japanese + Lang = language
   - Reflects trilingual founder (English, French, Japanese)
   - Domain to register: sanlang.app or sanlang.com

2. **User accounts: Freemium model**
   - Browse content without account
   - Account required to: save vocabulary, get tested, track progress
   - Reduces friction for new users while encouraging signup

3. **Content sources: Official sources**
   - JLPT vocabulary from official JLPT sources
   - TOEFL/SAT/GRE from official test prep materials
   - DELF/DALF from official French certification sources

4. **Auth: Clerk**
   - Replaces Firebase Auth
   - Better Convex integration
   - Built-in user management UI

5. **Database: Convex**
   - Real-time sync
   - TypeScript-first
   - Serverless functions

---

## Next Steps

### Immediate (Phase 1 - Payments & Core UI)
| Task | Status | Blocked By |
|------|--------|------------|
| Add Stripe integration for subscriptions | âœ… Complete | - |
| Build vocabulary input UI | âœ… Complete | - |
| Build flashcard review UI | âœ… Complete | - |
| Integrate OpenRouter for sentence generation | âœ… Complete | - |
| Create Convex action for AI calls | âœ… Complete | - |

### Short-term (Phase 1 - Audio & Polish)
| Task | Status | Blocked By |
|------|--------|------------|
| Integrate ElevenLabs for audio | âŒ Not Started | Sentence generation working |
| Test full flashcard flow end-to-end | âŒ Not Started | UI + AI integration |

### Medium-term
| Task | Status | Notes |
|------|--------|-------|
| Import JLPT vocabulary lists | âŒ Not Started | Need data source |
| Import TOEFL/SAT/GRE vocabulary | âŒ Not Started | Need data source |
| Build AI verification UI (Phase 2) | âŒ Not Started | After Phase 1 |

### Later
| Task | Status | Notes |
|------|--------|-------|
| Register domain (sanlang.app) | âŒ Not Started | Before public launch |
| Set up email provider | âŒ Not Started | Phase 8 |

---

## Document Control

**Version**: 2.3
**Last Updated**: 2026-01-21
**Status**: Active development - Phase 1 (Flashcard Foundation)
